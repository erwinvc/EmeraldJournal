@attribute [Authorize]
@using EmeraldJournal.Services
@using MudBlazor
@inject NavigationManager NavigationManager
@using Microsoft.AspNetCore.Identity
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject UserManager<IdentityUser> UserManager
@inject NavigationManager NavigationManager

<MudLayout>
    <MudAppBar Elevation="1">
        <AuthorizeView>
            <Authorized>
                <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start"
                    OnClick="@ToggleDrawer" />
                <MudSpacer />
            </Authorized>
        </AuthorizeView>
        <MudText Typo="Typo.h6" Class="appbar-title">EmeraldJournal</MudText>
        <AuthorizeView>
            <Authorized>
                <MudButton Variant="Variant.Text" StartIcon="@Icons.Material.Filled.Logout" Color="Color.Inherit"
                    OnClick="@(() => NavigationManager.NavigateTo("/logout"))">
                    Logout
                </MudButton>
            </Authorized>
            <NotAuthorized>
                <MudButton Variant="Variant.Text" StartIcon="@Icons.Material.Filled.Login" Color="Color.Inherit"
                    OnClick="@(() => NavigationManager.NavigateTo("/login"))">
                    Login
                </MudButton>
            </NotAuthorized>
        </AuthorizeView>
    </MudAppBar>
    <AuthorizeView>
        <Authorized>
            <MudDrawer @bind-Open="@_drawerOpen" ClipMode="DrawerClipMode.Always" Elevation="2">
                <NavMenu />
            </MudDrawer>
        </Authorized>
    </AuthorizeView>

    <MudMainContent Class="p-0">
        <MudContainer MaxWidth="MaxWidth.ExtraExtraLarge" DisableGutters="true" Class="pa-0">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    [Parameter]
    public RenderFragment? Body { get; set; }

    private bool _drawerOpen = true;

    void ToggleDrawer()
    {
        _drawerOpen = !_drawerOpen;
    }
}
<style>
    .appbar {
        position: relative;
    }

    .appbar-title {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        white-space: nowrap;
        /* optional */
    }
</style>